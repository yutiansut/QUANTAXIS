import datetime
import os
import copy

import jqdatasdk as jq

#jq.auth('YOUR name','Your pswd') #使用前先获得jq授权
from QUANTAXIS.QAUtil import QA_util_get_trade_range

future_map = {'SR': [['SR1505.XZCE', 'SR1509.XZCE', 'SR1601.XZCE', 'SR1605.XZCE', 'SR1609.XZCE', 'SR1701.XZCE', 'SR1705.XZCE', 'SR1709.XZCE', 'SR1801.XZCE', 'SR1805.XZCE', 'SR1809.XZCE', 'SR1901.XZCE', 'SR1905.XZCE', 'SR1909.XZCE', 'SR2001.XZCE', 'SR2005.XZCE'], ['2015-01-05', '2015-02-17', '2015-06-24', '2015-11-18', '2016-03-02', '2016-07-21', '2016-12-08', '2017-04-05', '2017-07-18', '2017-12-15', '2018-04-02', '2018-07-31', '2018-11-13', '2019-03-20', '2019-07-29', '2019-12-04']], 'I': [['I1505.XDCE', 'I1509.XDCE', 'I1601.XDCE', 'I1605.XDCE', 'I1609.XDCE', 'I1701.XDCE', 'I1705.XDCE', 'I1709.XDCE', 'I1801.XDCE', 'I1805.XDCE', 'I1809.XDCE', 'I1901.XDCE', 'I1905.XDCE', 'I1909.XDCE', 'I2001.XDCE', 'I2005.XDCE'], ['2015-01-05', '2015-03-10', '2015-07-22', '2015-11-24', '2016-03-22', '2016-08-12', '2016-11-28', '2017-03-23', '2017-08-02', '2017-11-24', '2018-04-09', '2018-08-08', '2018-12-03', '2019-04-09', '2019-08-01', '2019-12-09']], 'M': [['M1505.XDCE', 'M1509.XDCE', 'M1601.XDCE', 'M1605.XDCE', 'M1609.XDCE', 'M1701.XDCE', 'M1705.XDCE', 'M1709.XDCE', 'M1801.XDCE', 'M1805.XDCE', 'M1809.XDCE', 'M1901.XDCE', 'M1905.XDCE', 'M1909.XDCE', 'M2001.XDCE', 'M2005.XDCE'], ['2015-01-05', '2015-03-02', '2015-07-24', '2015-11-24', '2016-03-04', '2016-07-18', '2016-11-15', '2017-03-17', '2017-07-27', '2017-11-23', '2018-03-16', '2018-07-03', '2018-11-28', '2019-04-01', '2019-08-06', '2019-11-04']], 'P': [['P1505.XDCE', 'P1509.XDCE', 'P1601.XDCE', 'P1605.XDCE', 'P1609.XDCE', 'P1701.XDCE', 'P1705.XDCE', 'P1709.XDCE', 'P1801.XDCE', 'P1805.XDCE', 'P1809.XDCE', 'P1901.XDCE', 'P1905.XDCE', 'P1909.XDCE', 'P2001.XDCE', 'P2005.XDCE'], ['2015-01-05', '2015-03-06', '2015-06-05', '2015-11-30', '2016-03-16', '2016-07-07', '2016-11-24', '2017-03-10', '2017-07-06', '2017-11-21', '2018-03-22', '2018-07-23', '2018-12-04', '2019-04-11', '2019-08-06', '2019-11-28']], 'PP': [['PP1505.XDCE', 'PP1509.XDCE', 'PP1601.XDCE', 'PP1605.XDCE', 'PP1609.XDCE', 'PP1701.XDCE', 'PP1705.XDCE', 'PP1709.XDCE', 'PP1801.XDCE', 'PP1805.XDCE', 'PP1809.XDCE', 'PP1901.XDCE', 'PP1905.XDCE', 'PP1909.XDCE', 'PP2001.XDCE', 'PP2005.XDCE'], ['2015-01-05', '2015-03-19', '2015-08-05', '2015-11-26', '2016-03-29', '2016-08-12', '2016-12-02', '2017-04-12', '2017-08-10', '2017-12-04', '2018-04-10', '2018-08-08', '2018-12-07', '2019-04-09', '2019-08-02', '2019-12-09']], 'RR': [['.XDCE', 'RR2001.XDCE.XDCE', 'RR2005.XDCE.XDCE'], ['2015-01-05', '2019-08-19', '2019-12-16']], 'V': [['V1505.XDCE', 'V1509.XDCE', 'V1601.XDCE', 'V1605.XDCE', 'V1609.XDCE', 'V1701.XDCE', 'V1705.XDCE', 'V1709.XDCE', 'V1801.XDCE', 'V1805.XDCE', 'V1809.XDCE', 'V1901.XDCE', 'V1905.XDCE', 'V1909.XDCE', 'V2001.XDCE', 'V2005.XDCE'], ['2015-01-05', '2015-03-30', '2015-08-13', '2015-10-20', '2016-03-28', '2016-08-19', '2016-12-05', '2017-04-10', '2017-08-10', '2017-11-30', '2018-04-10', '2018-08-09', '2018-12-04', '2019-03-26', '2019-08-14', '2019-12-11']], 'Y': [['Y1505.XDCE', 'Y1509.XDCE', 'Y1601.XDCE', 'Y1605.XDCE', 'Y1609.XDCE', 'Y1701.XDCE', 'Y1705.XDCE', 'Y1709.XDCE', 'Y1801.XDCE', 'Y1805.XDCE', 'Y1809.XDCE', 'Y1901.XDCE', 'Y1905.XDCE', 'Y1909.XDCE', 'Y2001.XDCE', 'Y2005.XDCE'], ['2015-01-05', '2015-03-05', '2015-06-17', '2015-11-18', '2016-03-09', '2016-07-07', '2016-11-24', '2017-03-22', '2017-07-28', '2017-12-04', '2018-03-27', '2018-07-27', '2018-12-04', '2019-04-03', '2019-08-02', '2019-11-22']], 'AG': [['AG1506.XSGE', 'AG1512.XSGE', 'AG1606.XSGE', 'AG1612.XSGE', 'AG1706.XSGE', 'AG1712.XSGE', 'AG1806.XSGE', 'AG1812.XSGE', 'AG1906.XSGE', 'AG1912.XSGE', 'AG2002.XSGE', 'AG2006.XSGE'], ['2015-01-05', '2015-05-08', '2015-11-18', '2016-05-10', '2016-11-14', '2017-05-11', '2017-11-22', '2018-05-04', '2018-11-05', '2019-05-09', '2019-11-14', '2019-12-26']], 'AU': [['AU1506.XSGE', 'AU1512.XSGE', 'AU1606.XSGE', 'AU1612.XSGE', 'AU1706.XSGE', 'AU1712.XSGE', 'AU1806.XSGE', 'AU1812.XSGE', 'AU1906.XSGE', 'AU1912.XSGE', 'AU2006.XSGE'], ['2015-01-05', '2015-05-08', '2015-11-12', '2016-05-05', '2016-11-10', '2017-05-03', '2017-11-13', '2018-05-04', '2018-11-09', '2019-05-07', '2019-11-14']], 'CU': [['CU1503.XSGE', 'CU1504.XSGE', 'CU1505.XSGE', 'CU1506.XSGE', 'CU1507.XSGE', 'CU1508.XSGE', 'CU1509.XSGE', 'CU1510.XSGE', 'CU1511.XSGE', 'CU1512.XSGE', 'CU1601.XSGE', 'CU1602.XSGE', 'CU1603.XSGE', 'CU1604.XSGE', 'CU1605.XSGE', 'CU1606.XSGE', 'CU1607.XSGE', 'CU1608.XSGE', 'CU1609.XSGE', 'CU1610.XSGE', 'CU1611.XSGE', 'CU1612.XSGE', 'CU1701.XSGE', 'CU1702.XSGE', 'CU1703.XSGE', 'CU1704.XSGE', 'CU1705.XSGE', 'CU1706.XSGE', 'CU1707.XSGE', 'CU1708.XSGE', 'CU1709.XSGE', 'CU1710.XSGE', 'CU1711.XSGE', 'CU1712.XSGE', 'CU1801.XSGE', 'CU1802.XSGE', 'CU1803.XSGE', 'CU1804.XSGE', 'CU1805.XSGE', 'CU1806.XSGE', 'CU1807.XSGE', 'CU1808.XSGE', 'CU1809.XSGE', 'CU1810.XSGE', 'CU1811.XSGE', 'CU1812.XSGE', 'CU1901.XSGE', 'CU1902.XSGE', 'CU1903.XSGE', 'CU1904.XSGE', 'CU1905.XSGE', 'CU1906.XSGE', 'CU1907.XSGE', 'CU1908.XSGE', 'CU1909.XSGE', 'CU1910.XSGE', 'CU1911.XSGE', 'CU1912.XSGE', 'CU2001.XSGE', 'CU2002.XSGE', 'CU2003.XSGE'], ['2015-01-05', '2015-01-26', '2015-02-26', '2015-03-25', '2015-04-28', '2015-05-28', '2015-06-30', '2015-07-28', '2015-08-28', '2015-09-29', '2015-11-02', '2015-11-27', '2015-12-30', '2016-02-02', '2016-03-01', '2016-03-30', '2016-04-27', '2016-05-30', '2016-06-29', '2016-08-02', '2016-09-05', '2016-09-29', '2016-11-02', '2016-11-29', '2016-12-29', '2017-02-10', '2017-03-09', '2017-04-13', '2017-05-10', '2017-06-02', '2017-07-04', '2017-08-02', '2017-09-07', '2017-10-09', '2017-11-08', '2017-12-04', '2017-12-29', '2018-02-05', '2018-03-02', '2018-04-16', '2018-05-07', '2018-06-08', '2018-07-10', '2018-08-10', '2018-09-05', '2018-10-23', '2018-11-05', '2018-12-03', '2019-01-04', '2019-02-18', '2019-03-07', '2019-04-19', '2019-05-13', '2019-06-13', '2019-07-09', '2019-08-09', '2019-09-09', '2019-10-10', '2019-11-14', '2019-12-11', '2020-01-06']], 'HC': [['HC1505.XSGE', 'HC1510.XSGE', 'HC1601.XSGE', 'HC1605.XSGE', 'HC1610.XSGE', 'HC1701.XSGE', 'HC1705.XSGE', 'HC1710.XSGE', 'HC1801.XSGE', 'HC1805.XSGE', 'HC1810.XSGE', 'HC1901.XSGE', 'HC1905.XSGE', 'HC1910.XSGE', 'HC2001.XSGE', 'HC2005.XSGE'], ['2015-01-05', '2015-04-09', '2015-07-29', '2015-12-02', '2016-04-14', '2016-09-02', '2016-12-01', '2017-03-29', '2017-08-11', '2017-11-28', '2018-04-10', '2018-08-21', '2018-11-29', '2019-04-10', '2019-08-28', '2019-12-16']], 'NI': [['.XSGE', 'NI1507.XSGE', 'NI1509.XSGE', 'NI1601.XSGE', 'NI1605.XSGE', 'NI1609.XSGE', 'NI1701.XSGE', 'NI1705.XSGE', 'NI1709.XSGE', 'NI1801.XSGE', 'NI1805.XSGE', 'NI1807.XSGE', 'NI1809.XSGE', 'NI1811.XSGE', 'NI1901.XSGE', 'NI1905.XSGE', 'NI1906.XSGE', 'NI1907.XSGE', 'NI1908.XSGE', 'NI1909.XSGE', 'NI1910.XSGE', 'NI1911.XSGE', 'NI1912.XSGE', 'NI2001.XSGE', 'NI2002.XSGE', 'NI2003.XSGE'], ['2015-01-05', '2015-03-30', '2015-05-29', '2015-08-17', '2015-12-16', '2016-04-11', '2016-08-02', '2016-11-28', '2017-04-06', '2017-08-04', '2017-11-14', '2018-03-30', '2018-06-06', '2018-08-07', '2018-10-12', '2018-12-07', '2019-04-11', '2019-05-08', '2019-06-06', '2019-07-09', '2019-07-16', '2019-09-02', '2019-10-09', '2019-11-04', '2019-11-18', '2019-12-31']], 'NR': [['.XINE', 'NR2002.XINE.XINE', 'NR2003.XINE.XINE', 'NR2004.XINE.XINE'], ['2015-01-05', '2019-08-13', '2019-11-18', '2020-01-08']], 'PB': [['PB1502.XSGE', 'PB1503.XSGE', 'PB1504.XSGE', 'PB1505.XSGE', 'PB1506.XSGE', 'PB1507.XSGE', 'PB1508.XSGE', 'PB1509.XSGE', 'PB1510.XSGE', 'PB1511.XSGE', 'PB1512.XSGE', 'PB1601.XSGE', 'PB1602.XSGE', 'PB1603.XSGE', 'PB1604.XSGE', 'PB1605.XSGE', 'PB1606.XSGE', 'PB1607.XSGE', 'PB1608.XSGE', 'PB1609.XSGE', 'PB1610.XSGE', 'PB1611.XSGE', 'PB1612.XSGE', 'PB1701.XSGE', 'PB1702.XSGE', 'PB1703.XSGE', 'PB1704.XSGE', 'PB1705.XSGE', 'PB1706.XSGE', 'PB1707.XSGE', 'PB1708.XSGE', 'PB1709.XSGE', 'PB1710.XSGE', 'PB1711.XSGE', 'PB1712.XSGE', 'PB1801.XSGE', 'PB1802.XSGE', 'PB1803.XSGE', 'PB1804.XSGE', 'PB1805.XSGE', 'PB1806.XSGE', 'PB1807.XSGE', 'PB1808.XSGE', 'PB1809.XSGE', 'PB1810.XSGE', 'PB1811.XSGE', 'PB1812.XSGE', 'PB1901.XSGE', 'PB1902.XSGE', 'PB1903.XSGE', 'PB1904.XSGE', 'PB1905.XSGE', 'PB1906.XSGE', 'PB1907.XSGE', 'PB1908.XSGE', 'PB1909.XSGE', 'PB1910.XSGE', 'PB1911.XSGE', 'PB1912.XSGE', 'PB2001.XSGE', 'PB2002.XSGE', 'PB2003.XSGE'], ['2015-01-05', '2015-01-06', '2015-02-03', '2015-03-06', '2015-04-01', '2015-05-08', '2015-06-03', '2015-07-10', '2015-07-22', '2015-09-08', '2015-10-12', '2015-11-11', '2015-12-04', '2016-01-13', '2016-02-18', '2016-03-09', '2016-04-15', '2016-05-10', '2016-06-15', '2016-07-08', '2016-08-23', '2016-09-21', '2016-10-21', '2016-11-09', '2016-12-09', '2017-01-17', '2017-02-22', '2017-03-17', '2017-04-18', '2017-05-24', '2017-06-23', '2017-07-24', '2017-08-17', '2017-09-19', '2017-10-23', '2017-11-17', '2017-12-21', '2018-01-18', '2018-02-22', '2018-03-15', '2018-04-18', '2018-05-23', '2018-06-27', '2018-07-24', '2018-08-21', '2018-09-20', '2018-10-23', '2018-11-16', '2018-12-20', '2019-01-23', '2019-02-22', '2019-03-20', '2019-04-17', '2019-05-23', '2019-06-24', '2019-07-17', '2019-08-22', '2019-09-19', '2019-10-24', '2019-11-18', '2019-12-18', '2020-01-14']], 'RB': [['RB1505.XSGE', 'RB1510.XSGE', 'RB1601.XSGE', 'RB1605.XSGE', 'RB1610.XSGE', 'RB1701.XSGE', 'RB1705.XSGE', 'RB1710.XSGE', 'RB1801.XSGE', 'RB1805.XSGE', 'RB1810.XSGE', 'RB1901.XSGE', 'RB1905.XSGE', 'RB1910.XSGE', 'RB2001.XSGE', 'RB2005.XSGE'], ['2015-01-05', '2015-03-10', '2015-07-21', '2015-11-05', '2016-03-15', '2016-08-19', '2016-11-29', '2017-03-24', '2017-08-09', '2017-11-10', '2018-03-29', '2018-08-20', '2018-11-29', '2019-04-02', '2019-08-23', '2019-12-06']], 'RU': [['RU1505.XSGE', 'RU1509.XSGE', 'RU1601.XSGE', 'RU1605.XSGE', 'RU1609.XSGE', 'RU1701.XSGE', 'RU1705.XSGE', 'RU1709.XSGE', 'RU1801.XSGE', 'RU1805.XSGE', 'RU1809.XSGE', 'RU1901.XSGE', 'RU1905.XSGE', 'RU1909.XSGE', 'RU2001.XSGE', 'RU2005.XSGE'], ['2015-01-05', '2015-02-26', '2015-07-17', '2015-11-25', '2016-03-18', '2016-08-04', '2016-11-22', '2017-03-27', '2017-08-03', '2017-11-29', '2018-03-30', '2018-08-09', '2018-12-03', '2019-03-25', '2019-08-09', '2019-11-28']], 'SC': [['.XINE', 'SC1809.XINE', 'SC1812.XINE', 'SC1901.XINE', 'SC1903.XINE', 'SC1904.XINE', 'SC1905.XINE', 'SC1906.XINE', 'SC1907.XINE', 'SC1908.XINE', 'SC1909.XINE', 'SC1910.XINE', 'SC1911.XINE', 'SC1912.XINE', 'SC2001.XINE', 'SC2002.XINE', 'SC2003.XINE'], ['2015-01-05', '2018-03-27', '2018-08-10', '2018-11-20', '2018-12-19', '2019-02-19', '2019-03-19', '2019-04-18', '2019-05-22', '2019-06-19', '2019-07-17', '2019-08-16', '2019-09-10', '2019-10-14', '2019-11-18', '2019-12-11', '2020-01-06']], 'SN': [['.XSGE', 'SN1507.XSGE', 'SN1509.XSGE', 'SN1601.XSGE', 'SN1605.XSGE', 'SN1609.XSGE', 'SN1701.XSGE', 'SN1705.XSGE', 'SN1709.XSGE', 'SN1801.XSGE', 'SN1805.XSGE', 'SN1809.XSGE', 'SN1901.XSGE', 'SN1905.XSGE', 'SN1909.XSGE', 'SN2001.XSGE', 'SN2005.XSGE', 'SN2006.XSGE'], ['2015-01-05', '2015-03-30', '2015-07-03', '2015-09-15', '2015-12-23', '2016-05-05', '2016-09-01', '2017-01-03', '2017-04-27', '2017-08-31', '2017-12-26', '2018-04-19', '2018-08-16', '2018-12-07', '2019-04-11', '2019-08-12', '2019-12-05', '2020-01-06']], 'SP': [['.XSGE', 'SP1906.XSGE', 'SP1909.XSGE', 'SP2001.XSGE', 'SP2005.XSGE'], ['2015-01-05', '2018-11-28', '2019-05-07', '2019-08-12', '2019-12-13']], 'SS': [['.XSGE', 'SS2002.XSGE', 'SS2006.XSGE'], ['2015-01-05', '2019-09-26', '2020-01-02']], 'ZN': [['ZN1503.XSGE', 'ZN1504.XSGE', 'ZN1505.XSGE', 'ZN1506.XSGE', 'ZN1507.XSGE', 'ZN1508.XSGE', 'ZN1509.XSGE', 'ZN1510.XSGE', 'ZN1511.XSGE', 'ZN1512.XSGE', 'ZN1601.XSGE', 'ZN1602.XSGE', 'ZN1603.XSGE', 'ZN1604.XSGE', 'ZN1605.XSGE', 'ZN1606.XSGE', 'ZN1607.XSGE', 'ZN1608.XSGE', 'ZN1609.XSGE', 'ZN1610.XSGE', 'ZN1611.XSGE', 'ZN1612.XSGE', 'ZN1701.XSGE', 'ZN1702.XSGE', 'ZN1703.XSGE', 'ZN1704.XSGE', 'ZN1705.XSGE', 'ZN1706.XSGE', 'ZN1707.XSGE', 'ZN1708.XSGE', 'ZN1709.XSGE', 'ZN1710.XSGE', 'ZN1711.XSGE', 'ZN1712.XSGE', 'ZN1801.XSGE', 'ZN1802.XSGE', 'ZN1803.XSGE', 'ZN1804.XSGE', 'ZN1805.XSGE', 'ZN1806.XSGE', 'ZN1807.XSGE', 'ZN1808.XSGE', 'ZN1809.XSGE', 'ZN1810.XSGE', 'ZN1811.XSGE', 'ZN1812.XSGE', 'ZN1901.XSGE', 'ZN1902.XSGE', 'ZN1903.XSGE', 'ZN1904.XSGE', 'ZN1905.XSGE', 'ZN1906.XSGE', 'ZN1907.XSGE', 'ZN1908.XSGE', 'ZN1909.XSGE', 'ZN1910.XSGE', 'ZN1911.XSGE', 'ZN1912.XSGE', 'ZN2001.XSGE', 'ZN2002.XSGE', 'ZN2003.XSGE'], ['2015-01-05', '2015-01-28', '2015-02-27', '2015-03-25', '2015-04-24', '2015-05-27', '2015-06-29', '2015-07-30', '2015-09-01', '2015-09-29', '2015-11-02', '2015-11-27', '2015-12-31', '2016-02-03', '2016-03-03', '2016-03-30', '2016-05-04', '2016-06-02', '2016-07-01', '2016-08-01', '2016-09-01', '2016-10-11', '2016-11-01', '2016-12-01', '2016-12-29', '2017-02-14', '2017-03-07', '2017-04-10', '2017-05-09', '2017-06-08', '2017-07-06', '2017-08-08', '2017-09-06', '2017-10-12', '2017-11-03', '2017-12-06', '2018-01-05', '2018-02-07', '2018-03-06', '2018-04-04', '2018-05-07', '2018-06-11', '2018-07-09', '2018-08-08', '2018-09-07', '2018-10-22', '2018-11-05', '2018-12-04', '2019-01-08', '2019-02-19', '2019-03-08', '2019-04-12', '2019-05-09', '2019-06-12', '2019-07-08', '2019-08-09', '2019-09-09', '2019-10-15', '2019-11-12', '2019-12-06', '2020-01-07']], 'AP': [['.XZCE', 'AP1805.XZCE', 'AP1810.XZCE', 'AP1901.XZCE', 'AP1905.XZCE', 'AP1910.XZCE', 'AP2001.XZCE', 'AP2005.XZCE'], ['2015-01-05', '2017-12-25', '2018-04-13', '2018-07-13', '2018-11-09', '2019-04-16', '2019-09-16', '2019-12-19']], 'CF': [['CF1505.XZCE', 'CF1509.XZCE', 'CF1601.XZCE', 'CF1605.XZCE', 'CF1609.XZCE', 'CF1701.XZCE', 'CF1705.XZCE', 'CF1709.XZCE', 'CF1801.XZCE', 'CF1805.XZCE', 'CF1809.XZCE', 'CF1901.XZCE', 'CF1905.XZCE', 'CF1909.XZCE', 'CF2001.XZCE', 'CF2005.XZCE'], ['2015-01-05', '2015-03-23', '2015-07-03', '2015-10-23', '2016-02-04', '2016-06-22', '2016-11-23', '2017-04-05', '2017-08-04', '2017-11-29', '2018-03-27', '2018-05-15', '2018-11-22', '2019-04-04', '2019-08-09', '2019-11-26']], 'CJ': [['.XZCE', 'CJ1912.XZCE', 'CJ2001.XZCE', 'CJ2005.XZCE'], ['2015-01-05', '2019-05-06', '2019-11-07', '2019-12-04']], 'CY': [['.XZCE', 'CY1801.XZCE', 'CY180E.XZCE', 'CY1809.XZCE', 'CY1810.XZCE', 'CY1901.XZCE', 'CY1905.XZCE', 'CY200E.XZCE', 'CY2005.XZCE'], ['2015-01-05', '2017-08-21', '2017-12-18', '2018-02-07', '2018-05-10', '2018-10-09', '2019-01-03', '2019-04-17', '2019-12-05']], 'FG': [['FG1506.XZCE', 'FG1509.XZCE', 'FG1601.XZCE', 'FG1605.XZCE', 'FG1609.XZCE', 'FG1701.XZCE', 'FG1705.XZCE', 'FG1709.XZCE', 'FG1801.XZCE', 'FG1805.XZCE', 'FG1809.XZCE', 'FG1901.XZCE', 'FG1905.XZCE', 'FG1909.XZCE', 'FG2001.XZCE', 'FG2005.XZCE'], ['2015-01-05', '2015-04-09', '2015-08-11', '2015-12-03', '2016-04-08', '2016-08-15', '2016-12-06', '2017-04-12', '2017-08-11', '2017-11-30', '2018-04-11', '2018-08-10', '2018-12-14', '2019-04-15', '2019-08-12', '2019-12-11']], 'MA': [['MA1506.XZCE', 'MA1509.XZCE', 'MA1601.XZCE', 'MA1605.XZCE', 'MA1609.XZCE', 'MA1701.XZCE', 'MA1705.XZCE', 'MA1709.XZCE', 'MA1801.XZCE', 'MA1805.XZCE', 'MA1809.XZCE', 'MA1901.XZCE', 'MA1905.XZCE', 'MA1909.XZCE', 'MA2001.XZCE', 'MA2005.XZCE'], ['2015-01-05', '2015-04-20', '2015-07-28', '2015-12-01', '2016-04-11', '2016-08-10', '2016-12-05', '2017-04-10', '2017-08-08', '2017-12-12', '2018-04-13', '2018-08-10', '2018-12-13', '2019-04-15', '2019-08-19', '2019-12-16']], 'OI': [['OI1505.XZCE', 'OI1509.XZCE', 'OI1601.XZCE', 'OI1605.XZCE', 'OI1609.XZCE', 'OI1701.XZCE', 'OI1705.XZCE', 'OI1709.XZCE', 'OI1801.XZCE', 'OI1805.XZCE', 'OI1809.XZCE', 'OI1901.XZCE', 'OI1905.XZCE', 'OI1909.XZCE', 'OI2001.XZCE', 'OI2005.XZCE'], ['2015-01-05', '2015-03-11', '2015-06-15', '2015-11-11', '2016-03-09', '2016-07-05', '2016-11-23', '2017-03-16', '2017-07-06', '2017-11-20', '2018-03-22', '2018-07-03', '2018-12-05', '2019-04-03', '2019-08-01', '2019-12-10']], 'PM': [['PM1507.XZCE', 'PM1509.XZCE', 'PM1605.XZCE', 'PM1611.XZCE', 'PM1701.XZCE', 'PM1705.XZCE', 'PM1709.XZCE', 'PM1711.XZCE', 'PM1801.XZCE', 'PM1805.XZCE', 'PM1811.XZCE', 'PM1901.XZCE', 'PM1907.XZCE', 'PM1911.XZCE', 'PM2007.XZCE'], ['2015-01-05', '2015-01-07', '2015-05-22', '2016-04-28', '2016-09-07', '2017-01-05', '2017-04-06', '2017-09-15', '2017-11-15', '2017-12-27', '2018-05-16', '2018-08-07', '2018-11-23', '2019-07-15', '2019-08-28']], 'RI': [['RI1501.XZCE', 'RI1505.XZCE', 'RI1601.XZCE', 'RI1605.XZCE', 'RI1609.XZCE', 'RI1703.XZCE', 'RI1709.XZCE', 'RI1801.XZCE', 'RI1807.XZCE', 'RI1811.XZCE', 'RI1909.XZCE', 'RI2005.XZCE'], ['2015-01-05', '2015-01-06', '2015-03-23', '2016-01-05', '2016-01-22', '2016-05-19', '2016-09-21', '2017-09-06', '2017-11-10', '2018-03-30', '2018-11-15', '2019-09-17']], 'RM': [['RM1505.XZCE', 'RM1509.XZCE', 'RM1601.XZCE', 'RM1605.XZCE', 'RM1609.XZCE', 'RM1701.XZCE', 'RM1705.XZCE', 'RM1709.XZCE', 'RM1801.XZCE', 'RM1805.XZCE', 'RM1809.XZCE', 'RM1901.XZCE', 'RM1905.XZCE', 'RM1909.XZCE', 'RM2001.XZCE', 'RM2005.XZCE'], ['2015-01-05', '2015-03-04', '2015-07-27', '2015-12-02', '2016-03-15', '2016-08-08', '2016-11-29', '2017-03-21', '2017-08-03', '2017-12-07', '2018-03-28', '2018-07-27', '2018-11-28', '2019-04-02', '2019-08-09', '2019-12-05']], 'RS': [['RS1507.XZCE', 'RS1509.XZCE', 'RS1607.XZCE', 'RS1609.XZCE', 'RS1611.XZCE', 'RS1709.XZCE', 'RS1711.XZCE', 'RS1807.XZCE', 'RS1809.XZCE', 'RS1908.XZCE', 'RS1909.XZCE', 'RS1911.XZCE', 'RS2007.XZCE'], ['2015-01-05', '2015-05-27', '2015-09-17', '2016-07-15', '2016-09-19', '2016-11-15', '2017-09-15', '2017-10-10', '2018-01-31', '2018-08-31', '2018-12-06', '2019-02-22', '2019-11-15']], 'SA': [['.XZCE', 'SA2005.XZCE'], ['2015-01-05', '2019-12-09']], 'SF': [['SF1505.XZCE', 'SF1509.XZCE', 'SF1601.XZCE', 'SF1605.XZCE', 'SF1609.XZCE', 'SF1706.XZCE', 'SF1801.XZCE', 'SF1802.XZCE', 'SF1805.XZCE', 'SF1809.XZCE', 'SF1901.XZCE', 'SF1905.XZCE', 'SF1909.XZCE', 'SF2001.XZCE', 'SF2005.XZCE'], ['2015-01-05', '2015-05-05', '2015-08-11', '2015-12-29', '2016-05-04', '2016-07-12', '2017-02-22', '2017-03-15', '2017-12-18', '2018-04-23', '2018-08-17', '2018-12-25', '2019-04-24', '2019-08-26', '2019-12-24']], 'SM': [['SM1501.XZCE', 'SM1505.XZCE', 'SM1601.XZCE', 'SM1604.XZCE', 'SM1607.XZCE', 'SM1609.XZCE', 'SM1701.XZCE', 'SM1705.XZCE', 'SM1709.XZCE', 'SM1801.XZCE', 'SM1805.XZCE', 'SM1809.XZCE', 'SM1901.XZCE', 'SM1905.XZCE', 'SM1909.XZCE', 'SM2001.XZCE', 'SM2005.XZCE'], ['2015-01-05', '2015-01-19', '2015-05-06', '2015-07-02', '2015-07-30', '2016-05-03', '2016-09-01', '2016-12-15', '2017-04-18', '2017-08-14', '2017-12-25', '2018-04-26', '2018-08-16', '2018-12-25', '2019-04-22', '2019-08-21', '2019-12-17']], 'TA': [['TA1505.XZCE', 'TA1509.XZCE', 'TA1601.XZCE', 'TA1605.XZCE', 'TA1609.XZCE', 'TA1701.XZCE', 'TA1705.XZCE', 'TA1709.XZCE', 'TA1801.XZCE', 'TA1805.XZCE', 'TA1809.XZCE', 'TA1901.XZCE', 'TA1905.XZCE', 'TA1909.XZCE', 'TA2001.XZCE', 'TA2005.XZCE'], ['2015-01-05', '2015-04-01', '2015-08-07', '2015-11-25', '2016-03-31', '2016-08-08', '2016-11-16', '2017-04-10', '2017-08-08', '2017-11-24', '2018-03-28', '2018-08-08', '2018-12-03', '2019-04-10', '2019-08-16', '2019-12-12']], 'UR': [['.XZCE', 'UR2001.XZCE', 'UR2005.XZCE'], ['2015-01-05', '2019-08-12', '2019-12-13']], 'WH': [['WH1501.XZCE', 'WH1505.XZCE', 'WH1601.XZCE', 'WH1605.XZCE', 'WH1609.XZCE', 'WH1701.XZCE', 'WH1705.XZCE', 'WH1709.XZCE', 'WH1801.XZCE', 'WH1805.XZCE', 'WH1809.XZCE', 'WH1901.XZCE', 'WH1905.XZCE', 'WH1909.XZCE', 'WH2001.XZCE', 'WH2003.XZCE'], ['2015-01-05', '2015-01-19', '2015-05-18', '2015-10-21', '2016-04-19', '2016-07-20', '2016-12-23', '2017-04-27', '2017-07-11', '2017-12-29', '2018-04-17', '2018-07-16', '2018-12-27', '2019-04-26', '2019-09-11', '2020-01-13']], 'ZC': [['.XZCE', 'ZC1605.XZCE', 'ZC1609.XZCE', 'ZC1701.XZCE', 'ZC1705.XZCE', 'ZC1709.XZCE', 'ZC1801.XZCE', 'ZC1805.XZCE', 'ZC1809.XZCE', 'ZC1901.XZCE', 'ZC1905.XZCE', 'ZC1909.XZCE', 'ZC1911.XZCE', 'ZC2001.XZCE', 'ZC2005.XZCE'], ['2015-01-05', '2015-05-19', '2016-04-08', '2016-08-17', '2016-12-07', '2017-04-20', '2017-08-11', '2017-12-21', '2018-04-16', '2018-08-10', '2018-12-07', '2019-04-22', '2019-08-21', '2019-09-17', '2019-12-12']], 'A': [['A1505.XDCE', 'A1509.XDCE', 'A1601.XDCE', 'A1605.XDCE', 'A1609.XDCE', 'A1701.XDCE', 'A1705.XDCE', 'A1709.XDCE', 'A1801.XDCE', 'A1805.XDCE', 'A1809.XDCE', 'A1901.XDCE', 'A1905.XDCE', 'A1909.XDCE', 'A2001.XDCE', 'A2005.XDCE'], ['2015-01-05', '2015-04-10', '2015-06-17', '2015-11-06', '2016-03-10', '2016-07-15', '2016-11-30', '2017-03-24', '2017-08-07', '2017-12-12', '2018-04-10', '2018-07-31', '2018-12-25', '2019-04-23', '2019-08-13', '2019-12-05']], 'BB': [['BB1502.XDCE', 'BB1505.XDCE', 'BB1509.XDCE', 'BB1511.XDCE', 'BB1601.XDCE', 'BB1609.XDCE', 'BB1701.XDCE', 'BB1703.XDCE', 'BB1704.XDCE', 'BB1705.XDCE', 'BB1804.XDCE', 'BB1805.XDCE', 'BB1809.XDCE', 'BB1903.XDCE', 'BB1904.XDCE', 'BB1910.XDCE', 'BB2004.XDCE'], ['2015-01-05', '2015-01-30', '2015-05-05', '2015-09-17', '2015-11-16', '2016-01-18', '2016-06-08', '2017-01-17', '2017-03-15', '2017-04-07', '2017-05-16', '2018-01-16', '2018-05-09', '2018-09-17', '2019-03-05', '2019-03-19', '2019-10-22']], 'B': [['B1505.XDCE', 'B1509.XDCE', 'B1511.XDCE', 'B1601.XDCE', 'B1605.XDCE', 'B1701.XDCE', 'B1703.XDCE', 'B1705.XDCE', 'B1709.XDCE', 'B1805.XDCE', 'B1809.XDCE', 'B1901.XDCE', 'B1905.XDCE', 'B1906.XDCE', 'B1907.XDCE', 'B1908.XDCE', 'B1909.XDCE', 'B1910.XDCE', 'B1911.XDCE', 'B1912.XDCE', 'B2001.XDCE', 'B2002.XDCE', 'B2003.XDCE'], ['2015-01-05', '2015-04-10', '2015-09-17', '2015-10-12', '2015-11-23', '2016-02-03', '2016-04-15', '2017-01-06', '2017-03-16', '2017-06-02', '2018-02-22', '2018-07-23', '2018-09-03', '2019-04-08', '2019-05-08', '2019-06-05', '2019-07-02', '2019-08-05', '2019-09-03', '2019-10-10', '2019-11-05', '2019-12-04', '2020-01-06']], 'C': [['C1505.XDCE', 'C1509.XDCE', 'C1601.XDCE', 'C1605.XDCE', 'C1609.XDCE', 'C1701.XDCE', 'C1705.XDCE', 'C1709.XDCE', 'C1801.XDCE', 'C1805.XDCE', 'C1809.XDCE', 'C1901.XDCE', 'C1905.XDCE', 'C1909.XDCE', 'C2001.XDCE', 'C2005.XDCE'], ['2015-01-05', '2015-01-28', '2015-06-25', '2015-09-09', '2016-02-23', '2016-03-22', '2016-11-15', '2017-03-10', '2017-08-03', '2017-12-06', '2018-03-16', '2018-07-10', '2018-11-15', '2019-03-27', '2019-08-02', '2019-11-28']], 'CS': [['CS1505.XDCE', 'CS1509.XDCE', 'CS1601.XDCE', 'CS1605.XDCE', 'CS1609.XDCE', 'CS1701.XDCE', 'CS1705.XDCE', 'CS1709.XDCE', 'CS1801.XDCE', 'CS1805.XDCE', 'CS1809.XDCE', 'CS1901.XDCE', 'CS1905.XDCE', 'CS1909.XDCE', 'CS2001.XDCE', 'CS2005.XDCE'], ['2015-01-05', '2015-04-07', '2015-07-29', '2015-10-30', '2016-03-22', '2016-06-29', '2016-11-23', '2017-03-23', '2017-08-09', '2017-12-05', '2018-04-03', '2018-08-08', '2018-12-10', '2019-04-17', '2019-08-26', '2019-12-16']], 'EB': [['.XDCE', 'EB2005.XDCE.XDCE'], ['2015-01-05', '2019-09-27']], 'EG': [['.XDCE', 'EG1906.XDCE.XDCE', 'EG1909.XDCE.XDCE', 'EG2001.XDCE.XDCE', 'EG2005.XDCE.XDCE'], ['2015-01-05', '2018-12-11', '2019-05-06', '2019-08-06', '2019-12-06']], 'JD': [['JD1505.XDCE', 'JD1509.XDCE', 'JD1601.XDCE', 'JD1605.XDCE', 'JD1609.XDCE', 'JD1701.XDCE', 'JD1705.XDCE', 'JD1709.XDCE', 'JD1801.XDCE', 'JD1805.XDCE', 'JD1809.XDCE', 'JD1901.XDCE', 'JD1905.XDCE', 'JD1909.XDCE', 'JD2001.XDCE', 'JD2005.XDCE'], ['2015-01-05', '2015-03-25', '2015-08-05', '2015-11-27', '2016-03-25', '2016-08-02', '2016-11-30', '2017-04-13', '2017-08-03', '2017-12-04', '2018-04-10', '2018-08-07', '2018-12-10', '2019-04-08', '2019-08-06', '2019-12-03']], 'J': [['J1505.XDCE', 'J1509.XDCE', 'J1601.XDCE', 'J1605.XDCE', 'J1609.XDCE', 'J1701.XDCE', 'J1705.XDCE', 'J1709.XDCE', 'J1801.XDCE', 'J1805.XDCE', 'J1809.XDCE', 'J1901.XDCE', 'J1905.XDCE', 'J1909.XDCE', 'J2001.XDCE', 'J2005.XDCE'], ['2015-01-05', '2015-03-31', '2015-08-12', '2015-11-26', '2016-03-28', '2016-08-17', '2016-12-05', '2017-04-05', '2017-08-04', '2017-11-30', '2018-04-12', '2018-08-09', '2018-12-07', '2019-04-09', '2019-08-08', '2019-12-12']], 'JM': [['JM1505.XDCE', 'JM1509.XDCE', 'JM1601.XDCE', 'JM1605.XDCE', 'JM1609.XDCE', 'JM1701.XDCE', 'JM1705.XDCE', 'JM1709.XDCE', 'JM1801.XDCE', 'JM1805.XDCE', 'JM1809.XDCE', 'JM1901.XDCE', 'JM1905.XDCE', 'JM1909.XDCE', 'JM2001.XDCE', 'JM2005.XDCE'], ['2015-01-05', '2015-04-01', '2015-08-11', '2015-11-25', '2016-04-01', '2016-08-16', '2016-12-01', '2017-04-05', '2017-08-07', '2017-12-04', '2018-04-12', '2018-08-09', '2018-12-13', '2019-04-11', '2019-08-20', '2019-12-20']], 'L': [['L1505.XDCE', 'L1509.XDCE', 'L1601.XDCE', 'L1605.XDCE', 'L1609.XDCE', 'L1701.XDCE', 'L1705.XDCE', 'L1709.XDCE', 'L1801.XDCE', 'L1805.XDCE', 'L1809.XDCE', 'L1901.XDCE', 'L1905.XDCE', 'L1909.XDCE', 'L2001.XDCE', 'L2005.XDCE'], ['2015-01-05', '2015-03-19', '2015-08-05', '2015-11-27', '2016-03-28', '2016-07-26', '2016-11-29', '2017-04-10', '2017-07-31', '2017-11-29', '2018-04-09', '2018-07-31', '2018-11-19', '2019-04-02', '2019-08-02', '2019-12-05']], 'IC': [['.CCFX', 'IC1505.CCFX', 'IC1506.CCFX', 'IC1507.CCFX', 'IC1508.CCFX', 'IC1509.CCFX', 'IC1510.CCFX', 'IC1511.CCFX', 'IC1512.CCFX', 'IC1601.CCFX', 'IC1602.CCFX', 'IC1603.CCFX', 'IC1604.CCFX', 'IC1605.CCFX', 'IC1606.CCFX', 'IC1607.CCFX', 'IC1608.CCFX', 'IC1609.CCFX', 'IC1610.CCFX', 'IC1611.CCFX', 'IC1612.CCFX', 'IC1701.CCFX', 'IC1702.CCFX', 'IC1703.CCFX', 'IC1704.CCFX', 'IC1705.CCFX', 'IC1706.CCFX', 'IC1707.CCFX', 'IC1708.CCFX', 'IC1709.CCFX', 'IC1710.CCFX', 'IC1711.CCFX', 'IC1712.CCFX', 'IC1801.CCFX', 'IC1802.CCFX', 'IC1803.CCFX', 'IC1804.CCFX', 'IC1805.CCFX', 'IC1806.CCFX', 'IC1807.CCFX', 'IC1809.CCFX', 'IC1810.CCFX', 'IC1812.CCFX', 'IC1901.CCFX', 'IC1903.CCFX', 'IC1904.CCFX', 'IC1905.CCFX', 'IC1906.CCFX', 'IC1907.CCFX', 'IC1908.CCFX', 'IC1909.CCFX', 'IC1910.CCFX', 'IC1912.CCFX', 'IC2001.CCFX', 'IC2003.CCFX'], ['2015-01-05', '2015-04-17', '2015-05-15', '2015-06-19', '2015-07-17', '2015-08-20', '2015-09-21', '2015-10-19', '2015-11-20', '2015-12-21', '2016-01-18', '2016-02-19', '2016-03-21', '2016-04-18', '2016-05-19', '2016-06-20', '2016-07-18', '2016-08-18', '2016-09-19', '2016-10-21', '2016-11-16', '2016-12-16', '2017-01-20', '2017-02-15', '2017-03-17', '2017-04-21', '2017-05-17', '2017-06-16', '2017-07-24', '2017-08-17', '2017-09-18', '2017-10-23', '2017-11-16', '2017-12-15', '2018-01-22', '2018-02-12', '2018-03-19', '2018-04-23', '2018-05-17', '2018-06-15', '2018-07-19', '2018-09-21', '2018-10-17', '2018-12-21', '2019-01-17', '2019-03-18', '2019-04-22', '2019-05-17', '2019-06-24', '2019-07-22', '2019-08-15', '2019-09-23', '2019-10-18', '2019-12-20', '2020-01-15']], 'IF': [['IF1501.CCFX', 'IF1502.CCFX', 'IF1503.CCFX', 'IF1504.CCFX', 'IF1505.CCFX', 'IF1506.CCFX', 'IF1507.CCFX', 'IF1508.CCFX', 'IF1509.CCFX', 'IF1510.CCFX', 'IF1512.CCFX', 'IF1601.CCFX', 'IF1602.CCFX', 'IF1603.CCFX', 'IF1604.CCFX', 'IF1605.CCFX', 'IF1606.CCFX', 'IF1607.CCFX', 'IF1608.CCFX', 'IF1609.CCFX', 'IF1610.CCFX', 'IF1611.CCFX', 'IF1612.CCFX', 'IF1701.CCFX', 'IF1702.CCFX', 'IF1703.CCFX', 'IF1704.CCFX', 'IF1705.CCFX', 'IF1706.CCFX', 'IF1707.CCFX', 'IF1708.CCFX', 'IF1709.CCFX', 'IF1710.CCFX', 'IF1711.CCFX', 'IF1712.CCFX', 'IF1801.CCFX', 'IF1803.CCFX', 'IF1804.CCFX', 'IF1805.CCFX', 'IF1806.CCFX', 'IF1807.CCFX', 'IF1808.CCFX', 'IF1809.CCFX', 'IF1810.CCFX', 'IF1812.CCFX', 'IF1901.CCFX', 'IF1902.CCFX', 'IF1903.CCFX', 'IF1904.CCFX', 'IF1905.CCFX', 'IF1906.CCFX', 'IF1907.CCFX', 'IF1908.CCFX', 'IF1909.CCFX', 'IF1910.CCFX', 'IF1911.CCFX', 'IF1912.CCFX', 'IF2001.CCFX', 'IF2002.CCFX'], ['2015-01-05', '2015-01-16', '2015-02-13', '2015-03-20', '2015-04-20', '2015-05-14', '2015-06-19', '2015-07-20', '2015-08-20', '2015-09-21', '2015-10-16', '2015-12-21', '2016-01-18', '2016-02-18', '2016-03-21', '2016-04-18', '2016-05-19', '2016-06-17', '2016-07-15', '2016-08-18', '2016-09-19', '2016-10-21', '2016-11-17', '2016-12-16', '2017-01-20', '2017-02-15', '2017-03-17', '2017-04-21', '2017-05-18', '2017-06-16', '2017-07-24', '2017-08-16', '2017-09-18', '2017-10-23', '2017-11-15', '2017-12-15', '2018-01-19', '2018-03-19', '2018-04-23', '2018-05-17', '2018-06-19', '2018-07-23', '2018-08-15', '2018-09-21', '2018-10-19', '2018-12-24', '2019-01-21', '2019-02-12', '2019-03-18', '2019-04-22', '2019-05-17', '2019-06-24', '2019-07-22', '2019-08-16', '2019-09-23', '2019-10-21', '2019-11-15', '2019-12-23', '2020-01-20']], 'IH': [['.CCFX', 'IH1505.CCFX', 'IH1506.CCFX', 'IH1507.CCFX', 'IH1508.CCFX', 'IH1509.CCFX', 'IH1510.CCFX', 'IH1512.CCFX', 'IH1601.CCFX', 'IH1602.CCFX', 'IH1603.CCFX', 'IH1604.CCFX', 'IH1605.CCFX', 'IH1606.CCFX', 'IH1607.CCFX', 'IH1608.CCFX', 'IH1609.CCFX', 'IH1610.CCFX', 'IH1611.CCFX', 'IH1612.CCFX', 'IH1701.CCFX', 'IH1702.CCFX', 'IH1703.CCFX', 'IH1704.CCFX', 'IH1705.CCFX', 'IH1706.CCFX', 'IH1707.CCFX', 'IH1708.CCFX', 'IH1709.CCFX', 'IH1710.CCFX', 'IH1711.CCFX', 'IH1712.CCFX', 'IH1801.CCFX', 'IH1802.CCFX', 'IH1803.CCFX', 'IH1804.CCFX', 'IH1805.CCFX', 'IH1806.CCFX', 'IH1807.CCFX', 'IH1808.CCFX', 'IH1809.CCFX', 'IH1810.CCFX', 'IH1811.CCFX', 'IH1812.CCFX', 'IH1901.CCFX', 'IH1902.CCFX', 'IH1903.CCFX', 'IH1904.CCFX', 'IH1905.CCFX', 'IH1906.CCFX', 'IH1907.CCFX', 'IH1908.CCFX', 'IH1909.CCFX', 'IH1910.CCFX', 'IH1911.CCFX', 'IH1912.CCFX', 'IH2003.CCFX'], ['2015-01-05', '2015-04-17', '2015-05-15', '2015-06-23', '2015-07-20', '2015-08-21', '2015-09-21', '2015-10-19', '2015-12-18', '2016-01-18', '2016-02-18', '2016-03-21', '2016-04-18', '2016-05-19', '2016-06-17', '2016-07-15', '2016-08-17', '2016-09-19', '2016-10-21', '2016-11-16', '2016-12-16', '2017-01-20', '2017-02-15', '2017-03-17', '2017-04-21', '2017-05-18', '2017-06-16', '2017-07-24', '2017-08-17', '2017-09-18', '2017-10-23', '2017-11-16', '2017-12-18', '2018-01-22', '2018-02-14', '2018-03-19', '2018-04-23', '2018-05-18', '2018-06-19', '2018-07-23', '2018-08-17', '2018-09-25', '2018-10-22', '2018-11-16', '2018-12-24', '2019-01-21', '2019-02-15', '2019-03-18', '2019-04-22', '2019-05-17', '2019-06-24', '2019-07-22', '2019-08-16', '2019-09-23', '2019-10-21', '2019-11-14', '2019-12-20']], 'TF': [['TF1503.CCFX', 'TF1506.CCFX', 'TF1509.CCFX', 'TF1512.CCFX', 'TF1603.CCFX', 'TF1606.CCFX', 'TF1609.CCFX', 'TF1612.CCFX', 'TF1703.CCFX', 'TF1706.CCFX', 'TF1709.CCFX', 'TF1712.CCFX', 'TF1803.CCFX', 'TF1806.CCFX', 'TF1809.CCFX', 'TF1812.CCFX', 'TF1903.CCFX', 'TF1906.CCFX', 'TF1909.CCFX', 'TF1912.CCFX', 'TF2003.CCFX'], ['2015-01-05', '2015-02-05', '2015-05-18', '2015-08-19', '2015-11-19', '2016-02-15', '2016-04-29', '2016-08-12', '2016-11-11', '2017-01-25', '2017-05-12', '2017-08-11', '2017-11-13', '2018-02-13', '2018-05-17', '2018-08-15', '2018-11-20', '2019-02-21', '2019-05-22', '2019-08-14', '2019-11-21']], 'T': [['.CCFX', 'T1509.CCFX', 'T1512.CCFX', 'T1603.CCFX', 'T1606.CCFX', 'T1609.CCFX', 'T1612.CCFX', 'T1703.CCFX', 'T1706.CCFX', 'T1709.CCFX', 'T1712.CCFX', 'T1803.CCFX', 'T1806.CCFX', 'T1809.CCFX', 'T1812.CCFX', 'T1903.CCFX', 'T1906.CCFX', 'T1909.CCFX', 'T1912.CCFX', 'T2003.CCFX'], ['2015-01-05', '2015-03-23', '2015-08-14', '2015-11-16', '2016-02-05', '2016-05-06', '2016-08-10', '2016-11-10', '2017-01-19', '2017-05-10', '2017-08-09', '2017-11-10', '2018-02-08', '2018-05-18', '2018-08-15', '2018-11-15', '2019-02-21', '2019-05-21', '2019-08-15', '2019-11-19']], 'TS': [['.CCFX', 'TS1812.CCFX', 'TS1903.CCFX', 'TS1906.CCFX', 'TS1909.CCFX', 'TS1912.CCFX', 'TS2003.CCFX'], ['2015-01-05', '2018-08-20', '2018-12-03', '2019-03-04', '2019-05-27', '2019-08-20', '2019-11-13']]}
# map_end 这段是定位标志符,不可变更


def update_dominant_future_map(
        code,
        start='2015-01-02',
        end=datetime.datetime.now()
):
    """在线更新jqdata定义的主力合约月份列表,有一些交易不活跃的合约jq的数据也不是很准确
    
    Arguments:
        code {[type]} -- [description]
    
    Keyword Arguments:
        start {str} -- [description] (default: {'2015-01-02'})
        end {[type]} -- [description] (default: {datetime.datetime.now()})
    
    Returns:
        [dict] -- [{'I1705': '2017-03-02',
                    'I1709': '2017-03-23'}] #形如这样的dict,日期是这个这个主力合约的起始日
    """
    code = code.upper()
    days = QA_util_get_trade_range(start, end)
    cons_index = {}

    def init_add(i):
        con = jq.get_dominant_future(code, days[i])
        if con not in cons_index:
            cons_index[con] = [i]
        else:
            cons_index[con].append(i)

    for i in range(0, len(days) - 1, 30):
        init_add(i)

    #避免跳过了最后一日,单独加上
    init_add(len(days) - 1)

    def f(start, end):
        #二分法找con
        ind = (start + end) // 2
        con = jq.get_dominant_future(code, days[ind])
        return con, ind

    cons = list(cons_index.keys())
    for i in range(1, len(cons)):
        start = max(cons_index[cons[i - 1]])
        end = min(cons_index[cons[i]])
        while start + 1 != end: #如果没有找到相邻con的分界点就不停找
            con, ind = f(start, end)
            cons_index[con].append(ind)
            start = max(cons_index[cons[i - 1]])
            end = min(cons_index[cons[i]])
    for i in cons:
        start = days[min(cons_index[i])]
        cons_index[i] = start

    return [
        [x for x in list(cons_index.keys())],
        list(cons_index.values())
    ]


def save_dominant_future_map(code, res):
    future_map[code] = res

    abs_path = os.path.abspath(os.path.dirname(__file__)) + '/QAFutureMap.py'
    #content = '0'
    with open(abs_path, 'r') as file:
        content = file.read()
        start = content.index('future_map')
        end = content.index('# map_end')
        last_map = content[content.index('{'):content.index('map_end')]
        content = content.replace(last_map, str(future_map) + '\n# ')

    with open(abs_path, 'w') as file:
        file.write(content)


def get_dominant_future_map(code, start=None, end=None, update=False):
    """获取主力合约对应的月合约名,返回月合约名及对应的起始日期,
    如果指定start或者end,则返回这段时间对应的主力合约分界

    Arguments:
        code {[type]} -- [description]
    
    Keyword Arguments:
        start {[type]} -- [指定的开始日期] (default: {None})
        end {[type]} -- [指定的结束日期] (default: {None})
        update {bool} -- [是否更新] (default: {False})
    
    Returns:
        [[contracts,start_dates]] -- [[月合约名,对应的起始日]]
    """
    code = code.upper()
    if code not in future_map or update:
        res = update_dominant_future_map(code)
        future_map[code] = res
        save_dominant_future_map(code, res)
    [cons, days] = copy.deepcopy(future_map[code])

    if start is not None:
        for i in range(1, len(days)):
            if start >= days[i - 1] and start < days[i]:
                days[i - 1] = start
                days, cons = days[i - 1:], cons[i - 1:]
                break

    if end is not None:
        for i in range(1, len(days)):
            if end >= days[i - 1] and end < days[i]:
                days, cons = days[:i], cons[:i]
                break

    return [cons, days]


def get_dominant_future_by_day(code, day):
    """返回输入日期day对应的合约主力合约月份
    
    Arguments:
        code {[type]} -- [description]
        day {[type]} -- [description]
    """
    [cons, days] = get_dominant_future_map(code)
    res = 0
    for i in range(-1, -len(days) - 1, -1):
        if day > days[i]:
            res = cons[days.index(days[i])]
            break
    return res
